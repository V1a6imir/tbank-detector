# üè¶ TBank Logo Detector

–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –ª–æ–≥–æ—Ç–∏–ø–∞ T-–ë–∞–Ω–∫–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **YOLOv8**.  
–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –≤—Ä—É—á–Ω—É—é –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (zero-shot OWLv2 + CLIP), –¥–æ–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è–º–∏ –∏ —Ä–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–æ–π –≤—ã–±–æ—Ä–∫–∏.

---

## üìå –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
.
‚îú‚îÄ‚îÄ app/                      # REST API —Å–µ—Ä–≤–∏—Å (FastAPI + Uvicorn)
‚îÇ   ‚îú‚îÄ‚îÄ inference.py          # –ö–ª–∞—Å—Å TBankDetector –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îÇ   ‚îú‚îÄ‚îÄ main.py               # API —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îî‚îÄ‚îÄ schemas.py            # Pydantic-—Å—Ö–µ–º—ã
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ validation/           # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç (images, labels, validation.yaml)
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile            # Docker-—Å–±–æ—Ä–∫–∞
‚îú‚îÄ‚îÄ eval/
‚îÇ   ‚îî‚îÄ‚îÄ evaluate.py           # –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ—Ü–µ–Ω–∫–∏ IoU, Precision, Recall, F1
‚îú‚îÄ‚îÄ models/                   # –ü–∞–ø–∫–∞ –¥–ª—è –≤–µ—Å–æ–≤ (–ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º —Å–∫–∞—á–∞—Ç—å!)
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ prepare_zeroshot_labels.py  # –ê–≤—Ç–æ—Ä–∞–∑–º–µ—Ç–∫–∞ OWLv2+CLIP
‚îÇ   ‚îî‚îÄ‚îÄ validate.py           # –ó–∞–ø—É—Å–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ YOLO
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è API
‚îú‚îÄ‚îÄ requirements.train.txt    # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ train.py                  # –°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îî‚îÄ‚îÄ README.md                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```



---

## üìä –ü–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é

1. **–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö**  
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å—ã—Ä—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ª–æ–≥–æ—Ç–∏–ø–∞ T-–ë–∞–Ω–∫ –∏ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã.  
   - –ü—Ä–∏–º–µ–Ω—è–ª–∞—Å—å **zero-shot —Ä–∞–∑–º–µ—Ç–∫–∞** (OWLv2 + CLIP) –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–±–æ—Ä–∞ —á–∞—Å—Ç–∏ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–∏.  
   - –î–æ–±–∞–≤–ª–µ–Ω—ã **–Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã** (Tinkoff, –ø—É—Å—Ç—ã–µ —Å—Ü–µ–Ω—ã), —á—Ç–æ–±—ã –º–æ–¥–µ–ª—å –º–æ–≥–ª–∞ –æ—Ç–ª–∏—á–∞—Ç—å.  

2. **–ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏**  
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã Albumentations: flips, rotation, affine, color jitter, blur, brightness/contrast.  

3. **–†–µ–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞**  
   - –û–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ train/val.  
   - –û–±–µ—Å–ø–µ—á–µ–Ω–æ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.  

4. **–û–±—É—á–µ–Ω–∏–µ**  
   - –ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å: `yolov8n.pt`.  
   - –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞: 100 —ç–ø–æ—Ö, `imgsz=640`, –¥–∞—Ç–∞—Å–µ—Ç ‚Äî `data/yolo/data1.yaml`.  
   - –≠–∫—Å–ø–æ—Ä—Ç –ª—É—á—à–∏—Ö –≤–µ—Å–æ–≤ –≤ **ONNX** –∏ **PyTorch (.pt)**.  

5. **–ú–µ—Ç—Ä–∏–∫–∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏**

| –ú–µ—Ç—Ä–∏–∫–∞         | –ó–Ω–∞—á–µ–Ω–∏–µ |
|----------------|----------|
| Precision      | 0.924    |
| Recall         | 0.786    |
| F1@0.5         | 0.849    |
| mAP@0.5        | 0.867    |
| mAP@0.5:0.95   | 0.577    |

---

## üöÄ –ó–∞–ø—É—Å–∫ API

### 1. –°–∫–∞—á–∞—Ç—å –≤–µ—Å–∞ –º–æ–¥–µ–ª–∏

–°–∫–∞—á–∞–π—Ç–µ –æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ –∏ –ø–æ–º–µ—Å—Ç–∏—Ç–µ –∏—Ö –≤ –ø–∞–ø–∫—É `models/`:

- [best.pt (PyTorch)](https://drive.google.com/file/d/1SOwO4YIYLH1hZsfEtvb5G49BMsfU0aVh/view?usp=drive_link)  
- [best.onnx (ONNX)](https://drive.google.com/file/d/1iEsbGdPO2zp_7HKO2nV5yNwuEE8ZAJmI/view?usp=drive_link)  

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:
```
models/
‚îú‚îÄ‚îÄ best.pt
‚îî‚îÄ‚îÄ best.onnx

```


---

### 2. –°–±–æ—Ä–∫–∞ Docker-–æ–±—Ä–∞–∑–∞
```
git clone https://github.com/V1a6imir/tbank-detector.git
cd tbank-detector
docker build -t tbank-detector -f docker/Dockerfile .
```

### 3. –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞

```
docker run --rm -p 8000:8000 tbank-detector

```
–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É:

üëâ http://localhost:8000/docs

–ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —ç–Ω–¥–ø–æ–∏–Ω—Ç /detect, –∑–∞–≥—Ä—É–∑–∏–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.

### üìà –í–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª–∏

–î–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–∞ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ, –∑–∞–≤–µ—Ä—à–∏—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å ctrl+C –∞ –∑–∞—Ç–µ–º –æ—Å—Ç–∞–≤—è—Å—å –≤ –ø–∞–ø–∫–µ –ø—Ä–æ–µ–∫—Ç–∞ –≤–≤–µ–¥–∏—Ç–µ:

```
docker run --rm -v "$(pwd)/results:/app/results" tbank-detector python3 scripts/validate.py
```
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã:

–ú–µ—Ç—Ä–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ results/metrics.json.

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π ‚Äî –≤ runs/detect/val_with_preds/.

### üìö –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
YOLOv8 (Ultralytics)

 - FastAPI

- ONNX Runtime

- Albumentations

- OWLv2 + CLIP

### üîÆ –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
- –î–æ–±–∞–≤–∏—Ç—å hard negative mining (–ø–æ–∏—Å–∫ —Å–ª–æ–∂–Ω—ã—Ö –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤).

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ–ª–µ–µ —Ç—è–∂—ë–ª—É—é –º–æ–¥–µ–ª—å (yolov8m / yolov8l) –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏.

- –ü—Ä–∏–º–µ–Ω–∏—Ç—å distillation –¥–ª—è –æ–±–ª–µ–≥—á—ë–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ –∏ —É—Å–∫–æ—Ä–µ–Ω–∏—è API.

- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –ø–∞–π–ø–ª–∞–π–Ω –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è.

### üìú –õ–∏—Ü–µ–Ω–∑–∏—è
MIT ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —É—á–µ–±–Ω—ã—Ö –∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ü–µ–ª—è—Ö.

